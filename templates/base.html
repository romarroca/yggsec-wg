<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}YggSec{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
        crossorigin="anonymous">
  <link href="{{ url_for('static', filename='css/custom.css') }}" rel="stylesheet">
  <link rel="stylesheet" 
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
        integrity="sha384-tViUnnbYAV00FLIhhi3v/dWt3Jxw4gZQcNoSCxCIFNJVCx7/D55/wXsrNIRANwdD"
        crossorigin="anonymous">

  <!-- External theme stylesheets -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">

  {% block head_extra %}{% endblock %}
</head>
<body class="{% if not session.get('user') %}no-auth{% endif %}">
  <!-- Top bar -->
  <nav class="topbar navbar navbar-expand px-3">
    <div class="d-flex align-items-center">
      <span class="logo"></span>
      <span class="brand">YggSec - <small class="brand-subtitle">Simple and Secure</small></span>
    </div>
    <div class="ms-auto d-flex align-items-center gap-2">
      <button id="darkModeToggle" class="btn btn-sm btn-outline-secondary"><i class="bi bi-moon-stars"></i> Dark</button>

      {% if current_user %}
      <!-- Account dropdown replaces standalone Logout -->
      <div class="dropdown">
        <button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
          {{ current_user.username }}
        </button>
   	<ul class="dropdown-menu dropdown-menu-end">
 	 <li><a class="dropdown-item" href="{{ url_for('account') }}">Account settings</a></li>
 	 <li><hr class="dropdown-divider"></li>
 	 <li><a class="dropdown-item text-danger" href="{{ url_for('logout') }}">Logout</a></li>
	</ul>	
      </div>
      {% endif %}
    </div>
  </nav>

  <!-- App shell -->
  <div class="app">
    <div class="app-body">
      {% if session.get('user') %}
        <aside class="sidebar">
          <a class="nav-pill {% if request.path == '/' %}active{% endif %}" href="{{ url_for('index') }}">
            <i class="bi bi-house-door"></i> Home
          </a>
          <a class="nav-pill {% if request.path.startswith('/firewall') %}active{% endif %}" href="{{ url_for('firewall_page') }}">
            <i class="bi bi-shield-lock"></i> Firewall
          </a>
          <a class="nav-pill {% if request.path.startswith('/monitor') %}active{% endif %}" href="{{ url_for('monitor_page') }}">
            <i class="bi bi-activity"></i> Monitor
          </a>
	  <a class="nav-pill {% if request.path.startswith('/suricata') %}active{% endif %}" href="{{ url_for('suricata_page') }}">
	    <i class="bi bi-shield-exclamation"></i> IPS event (Suricata)
	  </a>

        </aside>
      {% endif %}

      <main class="main">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ 'success' if category == 'success' else ('danger' if category == 'error' else category) }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
      </main>
    </div>

    <footer class="app-footer text-center py-3">
      <small>
        YggSec WG (v1.0.0) © 2025 Romar Roca · Licensed under Apache 2.0 ·
        <a href="https://buymeacoffee.com/romarroca" target="_blank">Buy me a coffee</a>
      </small>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
          integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
          crossorigin="anonymous"></script>
  <script src="{{ url_for('static', filename='js/dark-mode.js') }}"></script>
  <script src="{{ url_for('static', filename='js/tooltips.js') }}"></script>
  <script src="{{ url_for('static', filename='js/alerts.js') }}"></script>

  {% block scripts %}{% endblock %}
</body>
</html>

